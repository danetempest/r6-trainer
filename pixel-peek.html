<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R6 Pixel Peek - Live Fire</title>
    <style>
        /* --- THEME SETUP --- */
        :root {
            --bg-color: #1e1e24;
            --wall-color: #0f0f12;
            --accent-color: #4cc9f0;
            --enemy-head: #e74c3c;
            --enemy-body: #c0392b;
        }

        body {
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            user-select: none;
        }

        /* --- THE GAME SCENE --- */
        #game-container {
            position: relative;
            width: 800px;
            height: 500px;
            background: radial-gradient(circle at center, #2b2b36 0%, #000 100%);
            border: 2px solid #333;
            border-radius: 8px;
            overflow: hidden;
            cursor: crosshair;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        /* The Cover (Right Side) */
        .wall {
            position: absolute;
            right: 0;
            top: 0;
            width: 50%; /* Covers pixels 400px to 800px */
            height: 100%;
            background: linear-gradient(90deg, #111 0%, var(--wall-color) 20%);
            border-left: 4px solid #000;
            z-index: 10; /* Important: Wall is ON TOP of enemy */
        }

        /* The Enemy Character */
        #enemy {
            position: absolute;
            /* FIXED: Put him DEEP inside the wall initially so he is hidden */
            right: 200px; 
            bottom: 140px;
            width: 60px;
            height: 140px;
            z-index: 5; /* Behind the wall */
            transition: transform 0.1s cubic-bezier(0.1, 0.7, 1.0, 0.1); /* Fast swing */
            display: none; 
        }

        /* Enemy Body Parts */
        .head {
            width: 40px; height: 40px;
            background-color: var(--enemy-head);
            border-radius: 50%;
            margin: 0 auto;
            border: 2px solid #5a0b0b;
        }
        .body {
            width: 60px; height: 100px;
            background-color: var(--enemy-body);
            border-radius: 8px;
            margin-top: -5px;
        }
        .gun {
            width: 50px; height: 10px; background: #000;
            position: absolute; top: 50px; left: -10px;
        }

        /* --- ANIMATIONS --- */
        
        /* FIXED: Swing distance increased to clear the wall */
        .swinging {
            transform: translateX(-350px); 
        }

        /* Dead Animation */
        .enemy-dead {
            transform: translateX(-350px) rotate(-90deg) translateY(100px) !important;
            transition: transform 0.3s ease-in !important;
            filter: grayscale(100%);
        }

        /* Overlays */
        .you-died-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 0, 0, 0.4);
            display: flex; align-items: center; justify-content: center;
            font-size: 5rem; font-weight: 900; color: #fff;
            text-shadow: 0 0 20px #000;
            opacity: 0; pointer-events: none; z-index: 100;
            transition: opacity 0.1s;
        }

        #ui-layer { position: absolute; top: 20px; left: 20px; font-size: 1.2rem; z-index: 20; }
        #start-msg {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem; font-weight: bold; color: var(--accent-color);
            z-index: 20; pointer-events: none;
        }
    </style>
</head>
<body onmousedown="fireShot()">

    <div id="game-container">
        <div id="ui-layer">
            <div>Reaction: <span id="time-disp" style="color:var(--accent-color)">0 ms</span></div>
            <div>Status: <span id="status-disp">Waiting...</span></div>
        </div>

        <div id="start-msg">CLICK SCREEN TO START</div>
        <div id="death-screen" class="you-died-overlay">YOU DIED</div>

        <div id="enemy">
            <div class="head"></div>
            <div class="body"><div class="gun"></div></div>
        </div>

        <div class="wall"></div>
    </div>

    <div style="margin-top: 20px; text-align: center; color: #888;">
        <p>Instructions: Click to start. Wait for the swing. <strong>Click immediately when he appears.</strong></p>
        <a href="index.html" style="color: var(--accent-color); text-decoration: none;">‚Üê Back to Dashboard</a>
    </div>

    <script>
        const enemyEl = document.getElementById('enemy');
        const deathScreen = document.getElementById('death-screen');
        const startMsg = document.getElementById('start-msg');
        const timeDisp = document.getElementById('time-disp');
        const statusDisp = document.getElementById('status-disp');

        let gameState = "IDLE"; 
        let swingTime = 0;
        let killTimer = null;
        
        // Settings
        const ENEMY_KILL_SPEED = 300; // Time (ms) before you die.

        function fireShot() {
            if (gameState === "IDLE" || gameState === "ENDED") {
                resetGame();
                return;
            }

            if (gameState === "HOLDING") {
                endGame("PREFIRE"); // Clicked too early
                return;
            }

            if (gameState === "SWINGING") {
                // Success
                const reactionTime = Date.now() - swingTime;
                killEnemy(reactionTime);
            }
        }

        function resetGame() {
            gameState = "HOLDING";
            clearTimeout(killTimer);
            
            // Reset Visuals
            enemyEl.style.display = "block"; // Render him (hidden behind wall)
            enemyEl.classList.remove("swinging", "enemy-dead"); 
            enemyEl.style.transform = ""; // Reset position to behind wall
            
            deathScreen.style.opacity = "0";
            startMsg.style.display = "none";
            statusDisp.innerText = "HOLDING ANGLE...";
            statusDisp.style.color = "#fff";
            timeDisp.innerText = "0 ms";

            // Random Delay 2-5s
            const randomDelay = Math.random() * 3000 + 2000;

            setTimeout(() => {
                // Only swing if we are still waiting (user hasn't clicked/reset)
                if(gameState === "HOLDING") {
                    enemySwing();
                }
            }, randomDelay);
        }

        function enemySwing() {
            gameState = "SWINGING";
            swingTime = Date.now();

            // 1. Move him out!
            enemyEl.classList.add("swinging");

            // 2. Start Death Timer
            killTimer = setTimeout(() => {
                if(gameState === "SWINGING") {
                    playerDies();
                }
            }, ENEMY_KILL_SPEED);
        }

        function killEnemy(ms) {
            clearTimeout(killTimer);
            gameState = "ENDED";
            enemyEl.classList.add("enemy-dead");
            statusDisp.innerText = "NICE SHOT!";
            statusDisp.style.color = "#2ecc71";
            timeDisp.innerText = ms + " ms";
            startMsg.innerText = "CLICK TO GO AGAIN";
            startMsg.style.display = "block";
        }

        function playerDies() {
            gameState = "ENDED";
            deathScreen.style.opacity = "1";
            statusDisp.innerText = "YOU DIED";
            statusDisp.style.color = "#e74c3c";
            startMsg.innerText = "CLICK TO RETRY";
            startMsg.style.display = "block";
        }

        function endGame(reason) {
            if(reason === "PREFIRE") {
                gameState = "ENDED";
                clearTimeout(killTimer);
                statusDisp.innerText = "PRE-FIRE! (Don't guess)";
                statusDisp.style.color = "orange";
                startMsg.innerText = "CLICK TO RETRY";
                startMsg.style.display = "block";
                
                // Show him so user knows he was there
                enemyEl.classList.add("swinging");
            }
        }
    </script>
</body>
</html>
